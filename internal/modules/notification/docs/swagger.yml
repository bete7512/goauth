paths:
  # Email Verification Routes
  /send-verification-email:
    post:
      summary: Send email verification
      description: Send verification email to user's email address
      tags: [Notification Module Docs]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendVerificationEmailRequest'
      responses:
        '200':
          description: Verification email sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Notification service error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /verify-email:
    get:
      summary: Verify email address
      description: Verify email address using verification token from email link. Redirects to frontend with success or error status.
      tags: [Notification Module Docs]
      parameters:
        - name: token
          in: query
          required: true
          schema:
            type: string
          description: Verification token from email
          example: abc123def456
      responses:
        '302':
          description: Redirects to frontend verify-email page with status and message query parameters
          headers:
            Location:
              description: Redirect URL to frontend
              schema:
                type: string
                example: http://localhost:3000/verify-email?status=success&message=Email%20verified%20successfully
        '400':
          description: Missing token or frontend config not set (fallback JSON response)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /resend-verification-email:
    post:
      summary: Resend email verification
      description: Resend verification email to user's email address
      tags: [Notification Module Docs]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendVerificationEmailRequest'
      responses:
        '200':
          description: Verification email resent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Phone Verification Routes
  /send-verification-phone:
    post:
      summary: Send phone verification
      description: Send verification SMS to user's phone number
      tags: [Notification Module Docs]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendVerificationPhoneRequest'
      responses:
        '200':
          description: Verification SMS sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Notification service error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /verify-phone:
    post:
      summary: Verify phone number
      description: Verify phone number using SMS verification code
      tags: [Notification Module Docs]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerifyPhoneRequest'
      responses:
        '200':
          description: Phone verified successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '400':
          description: Validation error or invalid code
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Verification service error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /resend-verification-phone:
    post:
      summary: Resend phone verification
      description: Resend verification SMS to user's phone number
      tags: [Notification Module Docs]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendVerificationPhoneRequest'
      responses:
        '200':
          description: Verification SMS resent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '429':
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Password Recovery Routes
  /forgot-password:
    post:
      summary: Request password reset
      description: Send password reset link/code via email or SMS
      tags: [Notification Module Docs]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
      responses:
        '200':
          description: Password reset instructions sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MessageResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Notification service error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    # Request Schemas
    SendVerificationEmailRequest:
      type: object
      required: [email]
      properties:
        email:
          type: string
          format: email
          example: user@example.com
          description: Email address to verify

    VerifyEmailRequest:
      type: object
      required: [token, email]
      properties:
        token:
          type: string
          example: abc123def456
          description: Verification token from email
        email:
          type: string
          format: email
          example: user@example.com
          description: Email address being verified

    SendVerificationPhoneRequest:
      type: object
      required: [phone_number]
      properties:
        phone_number:
          type: string
          pattern: '^\+[1-9]\d{1,14}$'
          example: +1234567890
          description: Phone number in E.164 format

    VerifyPhoneRequest:
      type: object
      required: [code, phone_number]
      properties:
        code:
          type: string
          pattern: '^\d{6}$'
          example: "123456"
          description: 6-digit verification code
        phone_number:
          type: string
          pattern: '^\+[1-9]\d{1,14}$'
          example: +1234567890
          description: Phone number

    ForgotPasswordRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          example: user@example.com
          description: Email address
        phone:
          type: string
          pattern: '^\+[1-9]\d{1,14}$'
          example: +1234567890
          description: Phone number in E.164 format

    # Response Schemas
    MessageResponse:
      type: object
      properties:
        message:
          type: string
          example: Verification email sent successfully
          description: Response message
        email:
          type: string
          format: email
          example: user@example.com
          description: Email address (for email operations)
        phone_number:
          type: string
          example: +1234567890
          description: Phone number (for phone operations)

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: Validation failed
          description: Error message
        message:
          type: string
          example: Additional error details
          description: Additional error information
        code:
          type: string
          example: "NOTIFICATION_ERROR"
          description: Error code

tags:
  - name: Notification Module Docs
    description: Notification Module API Documentation - Handles email/SMS verification and password reset notifications
